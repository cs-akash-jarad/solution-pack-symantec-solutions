{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Remediate Malware Alert (Symantec EDR \/ ATP)",
    "aliasName": null,
    "tag": "#Post-Create#Alert",
    "description": "Remediate malware alert by blocking malicious entities",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1632483193,
    "collection": "\/api\/3\/workflow_collections\/d33185a2-a85b-4c22-b428-a82f3dc8238a",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/0b52432d-d666-4ad1-b07b-dceaecf9ea03",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Isolate Endpoint",
            "description": null,
            "arguments": {
                "name": "Symantec ATP",
                "config": "74785d28-4798-404e-92bc-4c0f0a01a1c4",
                "params": {
                    "targets": "{{vars.request.data.deviceUID}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Isolated the device,<strong>{{vars.request.data.deviceUID}}&nbsp;&nbsp;<\/strong>successfully.&nbsp;<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "1.0.0",
                "connector": "symantec-atp",
                "operation": "isolate_endpoint",
                "mock_result": "{\n       \"command_id\": \"12daad22ddd23s12daad22ddd23s-2018-04-27\"\n }",
                "operationTitle": "Isolate Endpoint",
                "step_variables": []
            },
            "status": null,
            "top": "1515",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "279a8f21-8fc3-4795-adc3-95141837d02a",
            "id": 1335
        },
        {
            "@type": "WorkflowStep",
            "name": "Close Alert",
            "description": null,
            "arguments": {
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong><span style=\"color: #339966;\">Asset Contained.<\/span><\/strong><\/p>",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 6802,
                        "@id": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Closed",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Closed",
                        "orderIndex": 1
                    },
                    "closureNotes": "<p>Asset and user Containted<\/p>"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.alertIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1920",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "fc6c5313-f00e-4bde-bf33-694406101ed3",
            "id": 1336
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch Assets Details",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "deviceUid",
                            "value": "{{vars.input.records[0].deviceUID}}",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                },
                "module": "assets?$limit=30",
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "uuid": "41f1bfce-fbdd-4d0b-b5fe-51e705e284d3",
            "id": 1337
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "alerts",
                "resources": [
                    "alerts"
                ],
                "step_variables": {
                    "input": {
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    }
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "object",
                            "field": "type",
                            "value": "\/api\/3\/picklists\/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                            "_value": {
                                "itemValue": "Malware"
                            },
                            "operator": "eq"
                        },
                        {
                            "type": "primitive",
                            "field": "source",
                            "value": "Symantec EDR",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                }
            },
            "status": null,
            "top": "30",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/ea155646-3821-4542-9702-b246da430a8d",
            "uuid": "0b52432d-d666-4ad1-b07b-dceaecf9ea03",
            "id": 1338
        },
        {
            "@type": "WorkflowStep",
            "name": "Deactivate User in CloudSOC",
            "description": null,
            "arguments": {
                "name": "Symantec CloudSOC",
                "config": "3717065f-ef19-4c19-b038-5e3e0f86422f",
                "params": {
                    "email": "{{vars.steps.Fetch_Assets_Details[0].emailID}}",
                    "action": "Deactivate User"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>User:&nbsp;{{vars.steps.Fetch_Assets_Details[0].managedBy}} - has been blocked on Symantec CloudSOC<\/p>",
                    "records": ""
                },
                "version": "1.0.0",
                "connector": "symantec-cloudsoc",
                "operation": "modify_user",
                "mock_result": "{\n    \"data\":\n    {\n    \"Status\" : \"Success\"\n    }\n}",
                "operationTitle": "Modify User Activation",
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "0e7d72ef-5f75-40bf-9419-c5b259283f9c",
            "id": 1339
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "alertIRI": "{{vars.input.records[0]['@id']}}",
                "alertRawData": "{{vars.input.records[0].sourceData}}",
                "useMockOutput": "{{globalVars.Demo_mode}}"
            },
            "status": null,
            "top": "165",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "96dd56a2-8703-45cd-8c4f-c95e32061381",
            "id": 1340
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for Approved Isolation",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "['{{vars.alertIRI}}']",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong><span style=\"color: #008000;\">Containment request approved.<\/span><\/strong><\/p>\n<p>Proceeding to Isolate the Host<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1245",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "a5546c65-88f5-4fb0-abf6-1e9e32402a31",
            "id": 1341
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify IT team to start the asset clean up process",
            "description": null,
            "arguments": {
                "name": "SMTP",
                "config": "8dcaad2a-8cc4-4156-a95e-87e420f76a1f",
                "params": {
                    "cc": "user@example.com",
                    "to": "cyopsit_team@example.com",
                    "bcc": "",
                    "from": "no-reply@cybersponse.com",
                    "content": "<p>Hi Team,<\/p>\n<p>Following asset has been isolated due to malware infection.<\/p>\n<p>Please initiate asset clean-up procedure.<\/p>\n<p>Asset details:<\/p>\n<table border=\"1px solid black\" style=\"width: 732px; float: left;\">\n<tbody>\n<tr>\n<td style=\"width: 95px;\">Owner<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].managedBy}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">Device Name<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].hostname}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">IP Address<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].ip}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">Owner's Email ID<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].emailID}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">OS<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].operatingSystem.itemValue}}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<p>Infection details:<\/p>\n<table border=\"1px solid black\" style=\"width: 732px;\">\n<tbody>\n<tr>\n<td style=\"width: 146px;\">File Hashes&nbsp;<\/td>\n<td style=\"width: 237px;\">{% for item in vars.steps.Get_File_Reputation %}{% if \"Malicious\" in item.data.result.reputation %}{{item.data.result['SHA256']}}, {% endif %}{% endfor %}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<p>Thanks,<\/p>\n<p>InfoSec Team<\/p>",
                    "subject": "Clean Infected Asset : {{vars.steps.Fetch_Assets_Details[0].hostname}}",
                    "iri_list": "",
                    "file_name": "",
                    "file_path": ""
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Mailed IT Team to initiate the asset clean-up procedure.<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "2.4.2",
                "connector": "smtp",
                "operation": "send_richtext_email",
                "ignore_errors": true,
                "operationTitle": "Send Rich Text Email",
                "step_variables": []
            },
            "status": null,
            "top": "1785",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "4a3d7460-bf41-44f5-9c69-c0c3da94b1aa",
            "id": 1342
        },
        {
            "@type": "WorkflowStep",
            "name": "No Isolation is required",
            "description": null,
            "arguments": {
                "params": [],
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>No Isolation of endpoint is required<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "1245",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "d7de7ae2-b045-4469-af3a-382b86dc878c",
            "id": 1343
        },
        {
            "@type": "WorkflowStep",
            "name": "Create or Link Assets",
            "description": null,
            "arguments": {
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Found Asset details corresponding to the Device UID \"{{vars.request.data.deviceUID}}\":<br><strong>Owner<\/strong>:&nbsp;{{vars.steps.Fetch_Assets_Details[0].managedBy}} ({{vars.steps.Fetch_Assets_Details[0].emailId}})<br><strong>Hostname<\/strong>:&nbsp;{{vars.steps.Fetch_Assets_Details[0].hostname}}<br><strong>Asset Criticality<\/strong>:&nbsp;{{vars.steps.Fetch_Assets_Details[0].criticality.itemValue}}<\/p>",
                    "records": ""
                },
                "arguments": {
                    "assetIP": "",
                    "indicatorIRI": "{{vars.linkedIndicatorIRI}}",
                    "assetHostname": "{{vars.steps.Fetch_Assets_Details[0].hostname}}",
                    "alertRecordIRI": "{{vars.input.records[0]['@id']}}",
                    "incidentRecordIRI": ""
                },
                "apply_async": false,
                "step_variables": {
                    "linkedAssetIRI": "{{vars.result['@id']}}"
                },
                "workflowReference": "\/api\/3\/workflows\/24f12289-5860-4857-ac0e-354e65f46e18"
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "99d94eeb-5a2e-42c6-b75b-ead0fd19608b",
            "id": 1344
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Endpoint Isolation Required",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/ee2f6a67-45a4-4b0d-8e87-660a9546e62d",
                        "condition": "{{ \"Malicious\" in vars.fileReputations }}"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/a41584f1-0590-40a7-9229-74d9d56efbb0"
                    }
                ]
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "6e08e0d2-36df-41e0-ac32-c22cc1877991",
            "id": 1345
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<span style=\"font-size: 15px; color: #DE7A13;\" class=\"fa fa-exclamation-triangle\"><\/span>&nbsp;Investigating Potential {{vars.input.records[0].type.itemValue}}, with following fields of interest:\n{% if vars.input.records[0].domain %}Domain: {{vars.input.records[0].domain -}}{% endif %}\n{% if vars.input.records[0].sourceIp %}SourceIP: {{ vars.input.records[0].sourceIp -}}{% endif %}\n{% if vars.input.records[0].destinationIp %}DestinationIP: {{vars.input.records[0].destinationIp -}}{% endif %}\n{% if vars.input.records[0].fileHash %}File Hash: {{vars.input.records[0].fileHash -}}{% endif %}\n{% if vars.input.records[0].computerName %}ComputerName: {{vars.input.records[0].computerName -}}{% endif %}\n{% if vars.input.records[0].processName %}Process: {{vars.input.records[0].processName -}}{% endif %}\n{% if vars.input.records[0].sourceProcess %}SourceProcess: {{vars.input.records[0].sourceProcess -}}{% endif %}",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 113,
                        "@id": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Investigating",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Investigating",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "6301c0b9-c4e5-4698-bdad-c3f91941fe59",
            "id": 1346
        },
        {
            "@type": "WorkflowStep",
            "name": "Create note for the approval",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "['{{vars.alertIRI}}']",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Requested Approval from&nbsp;SOC team member&nbsp;to contain the User and Asset.<br><strong> <span style=\"background:#ba6204; color: #fff;\" class=\"badge badge-pill badge-danger\">Awaiting Confirmation.<\/span><\/strong><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "975",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "ee2f6a67-45a4-4b0d-8e87-660a9546e62d",
            "id": 1347
        },
        {
            "@type": "WorkflowStep",
            "name": "No malicious file found",
            "description": null,
            "arguments": {
                "params": [],
                "message": {
                    "tenant": "{{vars.input.records[0].type['@id']}}",
                    "content": "<p><strong><span style=\"color: #339966;\">No malicious<\/span><\/strong>&nbsp;File found<\/p>",
                    "records": ""
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "975",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "a41584f1-0590-40a7-9229-74d9d56efbb0",
            "id": 1348
        },
        {
            "@type": "WorkflowStep",
            "name": "Get File Reputation",
            "description": null,
            "arguments": {
                "name": "Symantec DeepSight Intelligence",
                "config": "caf0ac75-91ae-46ba-b9e1-ac82128fd442",
                "params": {
                    "filehash": "{{vars.input.records[0].fileHash}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong>Symantec DeepSight<\/strong>&nbsp;suggests Filehash&nbsp;{{vars.result[0].data.result.MD5}} to be&nbsp;<strong> <span style=\"background:#ba6204; color: #fff;\" class=\"badge badge-pill badge-danger\">{{vars.result[0].data.result.reputation}}<\/span><\/strong><\/p>",
                    "records": ""
                },
                "version": "1.0.1",
                "connector": "symantec-deepsight-intelligence",
                "operation": "filehash_reputation",
                "mock_result": "[\n    {\n      \"status\": \"Success\",\n      \"data\": {\n        \"status\": \"success\",\n        \"result\": {\n          \"MD5\": \"dc4200ac514006f084ead7f83b84c928\",\n          \"reputation\": \"Malicious\",\n          \"schemaVersion\": 3,\n          \"activity\": {\n            \"tcp\": [\n              {\n                \"port\": 443,\n                \"ip\": \"13.92.82.125\"\n              },\n              {\n                \"port\": 443,\n                \"ip\": \"131.253.61.102\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"23.192.125.50\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"72.21.91.29\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"104.18.24.243\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"208.185.118.90\"\n              }\n            ],\n            \"dns\": [\n              {\n                \"type\": \"A\",\n                \"target\": \"login.live.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"ocsp.digicert.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"ocsp.msocsp.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"crl.microsoft.com\"\n              }\n            ],\n            \"urls\": [\n              {\n                \"url\": \"http:\/\/ocsp.digicert.com\/MFEwTzBNMEswSTAJBgUrDgMCGgUABBTBL0V27RVZ7LBduom%2FnYB45SPUEwQU5Z1ZMIJHWMys%2BghUNoZ7OrUETfACEAi4elAbvpzaLRZNPjlRv1U%3D\"\n              },\n              {\n                \"url\": \"http:\/\/ocsp.msocsp.com\/MFQwUjBQME4wTDAJBgUrDgMCGgUABBRPC1vZt9qvn7bzY3Iidtbhla4mKQQUWIif1tycSCK3FD7%2FhIjo5oX%2F%2Bn0CE3sAACKeWuj3CySHT1IAAAAAIp4%3D\"\n              },\n              {\n                \"url\": \"http:\/\/crl.microsoft.com\/pki\/crl\/products\/tspca.crl\"\n              }\n            ],\n            \"udp\": [\n              {\n                \"port\": 3702,\n                \"ip\": \"239.255.255.250\"\n              }\n            ]\n          },\n          \"detectionName\": \"Infostealer.Chabibase\",\n          \"SHA256\": \"a850de0705c0f6095910aa1d5ed0e73a49581aa7427fcfaf2ff5144e93b047c1\"\n        }\n      },\n      \"operation\": \"filehash_reputation\",\n      \"message\": \"\"\n    }\n  ]",
                "operationTitle": "Get File Reputation",
                "step_variables": {
                    "fileReputations": "{{vars.result | json_query(\"[*].data.result.reputation\")}}"
                }
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "96a3b0bb-8a6d-4d16-880c-7514246fd9f5",
            "id": 1349
        },
        {
            "@type": "WorkflowStep",
            "name": "Seek approval to contain",
            "description": null,
            "arguments": {
                "type": "DecisionBased",
                "input": {
                    "schema": {
                        "title": "Approve Containment",
                        "description": "<p>Alert ID: {{vars.request.data.id}}<br \/>Please provide approval to contain <br \/>User ({{vars.steps.Fetch_Assets_Details[0].emailId}}) and <br \/>Endpoint (Device UID: {{vars.request.data.deviceUID}})<\/p>",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "owner_detail": {
                    "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Approve",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/a5546c65-88f5-4fb0-abf6-1e9e32402a31"
                        },
                        {
                            "option": "Reject",
                            "step_iri": "\/api\/3\/workflow_steps\/d7de7ae2-b045-4469-af3a-382b86dc878c"
                        }
                    ],
                    "duplicateOption": false
                }
            },
            "status": null,
            "top": "1110",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "e993f247-c093-4044-a262-7871b6410f8d",
            "id": 1350
        },
        {
            "@type": "WorkflowStep",
            "name": "Delete File from Endpoint",
            "description": null,
            "arguments": {
                "name": "Symantec ATP",
                "config": "eef74f1f-3d37-4b64-b774-8398ce9f548d",
                "params": {
                    "hash": "{{vars.item.data.result['SHA256']}}",
                    "device_uid": "{{vars.request.data.deviceUID}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Deleted the&nbsp;<strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">malicious<\/span>&nbsp;<\/strong>file hashes from device&nbsp;<strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">{{vars.request.data.deviceUID}}<\/span><\/strong><\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "1.0.0",
                "for_each": {
                    "item": "{{vars.steps.Get_File_Reputation}}",
                    "condition": "{{\"Malicious\" in vars.item.data.result.reputation or \"Trending Bad\" in vars.item.data.result.reputation}}"
                },
                "connector": "symantec-atp",
                "operation": "delete_endpoint_file",
                "mock_result": "[\n  {\n    \"command_id\": \"12daad562ddd23s12daad22ddd23s-2018-04-27\"\n  },\n  {\n    \"command_id\": \"12daad22ddd23s12daass2asd23s-2018-04-27\"\n  }\n]",
                "operationTitle": "Delete Endpoint File",
                "step_variables": []
            },
            "status": null,
            "top": "1380",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "7c311d18-25e1-4c5e-ae57-351a425af636",
            "id": 1351
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Get File Reputation -> Is Endpoint Isolation Required",
            "targetStep": "\/api\/3\/workflow_steps\/6e08e0d2-36df-41e0-ac32-c22cc1877991",
            "sourceStep": "\/api\/3\/workflow_steps\/96a3b0bb-8a6d-4d16-880c-7514246fd9f5",
            "label": null,
            "isExecuted": false,
            "uuid": "247ece6e-6545-4467-a63d-4e2005104e2e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Seek approval to contain -> No Isolation is required",
            "targetStep": "\/api\/3\/workflow_steps\/d7de7ae2-b045-4469-af3a-382b86dc878c",
            "sourceStep": "\/api\/3\/workflow_steps\/e993f247-c093-4044-a262-7871b6410f8d",
            "label": "Reject",
            "isExecuted": false,
            "uuid": "0f8673a0-ad02-442c-8dae-c22e4194d01c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Fetch Assets Details",
            "targetStep": "\/api\/3\/workflow_steps\/41f1bfce-fbdd-4d0b-b5fe-51e705e284d3",
            "sourceStep": "\/api\/3\/workflow_steps\/6301c0b9-c4e5-4698-bdad-c3f91941fe59",
            "label": null,
            "isExecuted": false,
            "uuid": "48464bae-078c-44d8-a3d8-a492bd250920"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Endpoint Isolation Required -> No malicious file found1",
            "targetStep": "\/api\/3\/workflow_steps\/a41584f1-0590-40a7-9229-74d9d56efbb0",
            "sourceStep": "\/api\/3\/workflow_steps\/6e08e0d2-36df-41e0-ac32-c22cc1877991",
            "label": "No",
            "isExecuted": false,
            "uuid": "25628f71-e8ba-40ee-ba52-29f1c19b0013"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch Assets Details -> Create or Link Assets",
            "targetStep": "\/api\/3\/workflow_steps\/99d94eeb-5a2e-42c6-b75b-ead0fd19608b",
            "sourceStep": "\/api\/3\/workflow_steps\/41f1bfce-fbdd-4d0b-b5fe-51e705e284d3",
            "label": null,
            "isExecuted": false,
            "uuid": "3d50ab29-046a-4c3e-8e3c-a1274ef36555"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Seek approval to contain -> Create Note for Approved Isolation",
            "targetStep": "\/api\/3\/workflow_steps\/a5546c65-88f5-4fb0-abf6-1e9e32402a31",
            "sourceStep": "\/api\/3\/workflow_steps\/e993f247-c093-4044-a262-7871b6410f8d",
            "label": "Approve",
            "isExecuted": false,
            "uuid": "1d8f6dc1-84cb-4efe-bdbf-e168a7bca003"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Note for Approved Isolation -> Delete File from Endpoint",
            "targetStep": "\/api\/3\/workflow_steps\/7c311d18-25e1-4c5e-ae57-351a425af636",
            "sourceStep": "\/api\/3\/workflow_steps\/a5546c65-88f5-4fb0-abf6-1e9e32402a31",
            "label": null,
            "isExecuted": false,
            "uuid": "a8bb11c9-ebac-4ea5-a185-e688250e1c21"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Isolate Endpoint -> Deactivate User in CloudSOC",
            "targetStep": "\/api\/3\/workflow_steps\/0e7d72ef-5f75-40bf-9419-c5b259283f9c",
            "sourceStep": "\/api\/3\/workflow_steps\/279a8f21-8fc3-4795-adc3-95141837d02a",
            "label": null,
            "isExecuted": false,
            "uuid": "006ef14b-4dba-4c34-a856-6c1429849ac7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/96dd56a2-8703-45cd-8c4f-c95e32061381",
            "sourceStep": "\/api\/3\/workflow_steps\/0b52432d-d666-4ad1-b07b-dceaecf9ea03",
            "label": null,
            "isExecuted": false,
            "uuid": "f5ab337b-265c-4b21-856f-38d748f88b31"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/6301c0b9-c4e5-4698-bdad-c3f91941fe59",
            "sourceStep": "\/api\/3\/workflow_steps\/96dd56a2-8703-45cd-8c4f-c95e32061381",
            "label": null,
            "isExecuted": false,
            "uuid": "d7e38609-62f2-44a9-b982-29f1e0e2e4b0"
        },
        {
            "@type": "WorkflowRoute",
            "name": "is Endpoint Isolation Required -> Create note for the approval",
            "targetStep": "\/api\/3\/workflow_steps\/ee2f6a67-45a4-4b0d-8e87-660a9546e62d",
            "sourceStep": "\/api\/3\/workflow_steps\/6e08e0d2-36df-41e0-ac32-c22cc1877991",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "5be2a8e6-872f-4c1a-9c35-60b7b6d08332"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create note for the approval -> Seek approval to contain",
            "targetStep": "\/api\/3\/workflow_steps\/e993f247-c093-4044-a262-7871b6410f8d",
            "sourceStep": "\/api\/3\/workflow_steps\/ee2f6a67-45a4-4b0d-8e87-660a9546e62d",
            "label": null,
            "isExecuted": false,
            "uuid": "a6b2d473-9ecd-4fe1-9609-cbb267d8a8ab"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Notify IT team to start the asset clean up process -> Closing Alert record",
            "targetStep": "\/api\/3\/workflow_steps\/fc6c5313-f00e-4bde-bf33-694406101ed3",
            "sourceStep": "\/api\/3\/workflow_steps\/4a3d7460-bf41-44f5-9c69-c0c3da94b1aa",
            "label": null,
            "isExecuted": false,
            "uuid": "52d2e01c-6c4c-4c4f-bfc3-5195cd6f8df1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Delete File from Endpoint -> Isolate Endpoint",
            "targetStep": "\/api\/3\/workflow_steps\/279a8f21-8fc3-4795-adc3-95141837d02a",
            "sourceStep": "\/api\/3\/workflow_steps\/7c311d18-25e1-4c5e-ae57-351a425af636",
            "label": null,
            "isExecuted": false,
            "uuid": "3976dcb5-15e3-480d-a9a4-1a14d832f4b5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create or Link Assets -> Get File Reputation",
            "targetStep": "\/api\/3\/workflow_steps\/96a3b0bb-8a6d-4d16-880c-7514246fd9f5",
            "sourceStep": "\/api\/3\/workflow_steps\/99d94eeb-5a2e-42c6-b75b-ead0fd19608b",
            "label": null,
            "isExecuted": false,
            "uuid": "7fbb07fb-329b-4087-944f-fd1b2e74e5b8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Deactivate User in CloudSOC -> Notify IT team to start the asset clean up process",
            "targetStep": "\/api\/3\/workflow_steps\/4a3d7460-bf41-44f5-9c69-c0c3da94b1aa",
            "sourceStep": "\/api\/3\/workflow_steps\/0e7d72ef-5f75-40bf-9419-c5b259283f9c",
            "label": null,
            "isExecuted": false,
            "uuid": "e0d425d8-3e74-4643-b039-c5f8b8ca44e0"
        }
    ],
    "priority": null,
    "uuid": "3f11ef71-f1c7-497d-af2d-9f9b6be061d0",
    "recordTags": [
        "PostCreate",
        "Alerts"
    ],
    "id": 166,
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1632483200,
    "modifyUser": "\/api\/3\/people\/f661cf65-91d4-4f00-9169-b92981aee43d",
    "modifyDate": 1632727175,
    "owners": [],
    "isPrivate": false
}