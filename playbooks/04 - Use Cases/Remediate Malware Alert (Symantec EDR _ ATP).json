{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Remediate Malware Alert (Symantec EDR \/ ATP)",
    "aliasName": null,
    "tag": "#Post-Create#Alert",
    "description": "Remediate malware alert by blocking malicious entities",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1637679536,
    "collection": "\/api\/3\/workflow_collections\/d33185a2-a85b-4c22-b428-a82f3dc8238a",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/5ba36f7e-5f3f-4737-acfa-778cc2f40471",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Get File Reputation",
            "description": null,
            "arguments": {
                "name": "Symantec DeepSight Intelligence",
                "config": "caf0ac75-91ae-46ba-b9e1-ac82128fd442",
                "params": {
                    "filehash": "{{vars.input.records[0].fileHash}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong>Symantec DeepSight<\/strong>&nbsp;suggests Filehash&nbsp;{{vars.result[0].data.result.MD5}} to be&nbsp;<strong> <span style=\"background:#ba6204; color: #fff;\" class=\"badge badge-pill badge-danger\">{{vars.result[0].data.result.reputation}}<\/span><\/strong><\/p>",
                    "records": ""
                },
                "version": "1.0.1",
                "connector": "symantec-deepsight-intelligence",
                "operation": "filehash_reputation",
                "mock_result": "[\n    {\n      \"status\": \"Success\",\n      \"data\": {\n        \"status\": \"success\",\n        \"result\": {\n          \"MD5\": \"dc4200ac514006f084ead7f83b84c928\",\n          \"reputation\": \"Malicious\",\n          \"schemaVersion\": 3,\n          \"activity\": {\n            \"tcp\": [\n              {\n                \"port\": 443,\n                \"ip\": \"13.92.82.125\"\n              },\n              {\n                \"port\": 443,\n                \"ip\": \"131.253.61.102\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"23.192.125.50\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"72.21.91.29\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"104.18.24.243\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"208.185.118.90\"\n              }\n            ],\n            \"dns\": [\n              {\n                \"type\": \"A\",\n                \"target\": \"login.live.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"ocsp.digicert.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"ocsp.msocsp.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"crl.microsoft.com\"\n              }\n            ],\n            \"urls\": [\n              {\n                \"url\": \"http:\/\/ocsp.digicert.com\/MFEwTzBNMEswSTAJBgUrDgMCGgUABBTBL0V27RVZ7LBduom%2FnYB45SPUEwQU5Z1ZMIJHWMys%2BghUNoZ7OrUETfACEAi4elAbvpzaLRZNPjlRv1U%3D\"\n              },\n              {\n                \"url\": \"http:\/\/ocsp.msocsp.com\/MFQwUjBQME4wTDAJBgUrDgMCGgUABBRPC1vZt9qvn7bzY3Iidtbhla4mKQQUWIif1tycSCK3FD7%2FhIjo5oX%2F%2Bn0CE3sAACKeWuj3CySHT1IAAAAAIp4%3D\"\n              },\n              {\n                \"url\": \"http:\/\/crl.microsoft.com\/pki\/crl\/products\/tspca.crl\"\n              }\n            ],\n            \"udp\": [\n              {\n                \"port\": 3702,\n                \"ip\": \"239.255.255.250\"\n              }\n            ]\n          },\n          \"detectionName\": \"Infostealer.Chabibase\",\n          \"SHA256\": \"a850de0705c0f6095910aa1d5ed0e73a49581aa7427fcfaf2ff5144e93b047c1\"\n        }\n      },\n      \"operation\": \"filehash_reputation\",\n      \"message\": \"\"\n    }\n  ]",
                "operationTitle": "Get File Reputation",
                "step_variables": {
                    "fileReputations": "{{vars.result | json_query(\"[*].data.result.reputation\")}}"
                }
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "01fa6bd9-58e6-4c81-ab97-e95903e90835",
            "id": 319
        },
        {
            "@type": "WorkflowStep",
            "name": "Create or Link Assets",
            "description": null,
            "arguments": {
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Found Asset details corresponding to the Device UID \"{{vars.request.data.deviceUID}}\":<br><strong>Owner<\/strong>:&nbsp;{{vars.steps.Fetch_Assets_Details[0].managedBy}} ({{vars.steps.Fetch_Assets_Details[0].emailId}})<br><strong>Hostname<\/strong>:&nbsp;{{vars.steps.Fetch_Assets_Details[0].hostname}}<br><strong>Asset Criticality<\/strong>:&nbsp;{{vars.steps.Fetch_Assets_Details[0].criticality.itemValue}}<\/p>",
                    "records": ""
                },
                "arguments": {
                    "assetIP": "",
                    "indicatorIRI": "{{vars.linkedIndicatorIRI}}",
                    "assetHostname": "{{vars.steps.Fetch_Assets_Details[0].hostname}}",
                    "alertRecordIRI": "{{vars.input.records[0]['@id']}}",
                    "incidentRecordIRI": ""
                },
                "apply_async": false,
                "step_variables": {
                    "linkedAssetIRI": "{{vars.result['@id']}}"
                },
                "workflowReference": "\/api\/3\/workflows\/24f12289-5860-4857-ac0e-354e65f46e18"
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "0e1b8eb7-a564-4145-bf61-dce1dec49665",
            "id": 314
        },
        {
            "@type": "WorkflowStep",
            "name": "Delete File from Endpoint",
            "description": null,
            "arguments": {
                "name": "Symantec ATP",
                "config": "eef74f1f-3d37-4b64-b774-8398ce9f548d",
                "params": {
                    "hash": "{{vars.item.data.result['SHA256']}}",
                    "device_uid": "{{vars.request.data.deviceUID}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Deleted the&nbsp;<strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">malicious<\/span>&nbsp;<\/strong>file hashes from device&nbsp;<strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">{{vars.request.data.deviceUID}}<\/span><\/strong><\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "1.0.0",
                "for_each": {
                    "item": "{{vars.steps.Get_File_Reputation}}",
                    "condition": "{{\"Malicious\" in vars.item.data.result.reputation or \"Trending Bad\" in vars.item.data.result.reputation}}"
                },
                "connector": "symantec-atp",
                "operation": "delete_endpoint_file",
                "mock_result": "[\n  {\n    \"command_id\": \"12daad562ddd23s12daad22ddd23s-2018-04-27\"\n  },\n  {\n    \"command_id\": \"12daad22ddd23s12daass2asd23s-2018-04-27\"\n  }\n]",
                "operationTitle": "Delete Endpoint File",
                "step_variables": []
            },
            "status": null,
            "top": "1380",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "36b65970-019a-4dc5-b697-f02c730fdfca",
            "id": 321
        },
        {
            "@type": "WorkflowStep",
            "name": "Seek approval to contain",
            "description": null,
            "arguments": {
                "type": "DecisionBased",
                "input": {
                    "schema": {
                        "title": "Approve Containment",
                        "description": "<p>Alert ID: {{vars.request.data.id}}<br \/>Please provide approval to contain <br \/>User ({{vars.steps.Fetch_Assets_Details[0].emailId}}) and <br \/>Endpoint (Device UID: {{vars.request.data.deviceUID}})<\/p>",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "owner_detail": {
                    "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Approve",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/bf0ae666-7bd4-4a1f-b771-7ad666a85ac1"
                        },
                        {
                            "option": "Reject",
                            "step_iri": "\/api\/3\/workflow_steps\/fcdc8a64-b1d1-467b-bec7-1d7f2e82bcfd"
                        }
                    ],
                    "duplicateOption": false
                }
            },
            "status": null,
            "top": "1110",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "3ffbda07-e69e-4f98-9bd7-ce7e2fcc93a6",
            "id": 320
        },
        {
            "@type": "WorkflowStep",
            "name": "Deactivate User in CloudSOC",
            "description": null,
            "arguments": {
                "name": "Symantec CloudSOC",
                "config": "3717065f-ef19-4c19-b038-5e3e0f86422f",
                "params": {
                    "email": "{{vars.steps.Fetch_Assets_Details[0].emailID}}",
                    "action": "Deactivate User"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>User:&nbsp;{{vars.steps.Fetch_Assets_Details[0].managedBy}} - has been blocked on Symantec CloudSOC<\/p>",
                    "records": ""
                },
                "version": "1.0.0",
                "connector": "symantec-cloudsoc",
                "operation": "modify_user",
                "mock_result": "{\n    \"data\":\n    {\n    \"Status\" : \"Success\"\n    }\n}",
                "operationTitle": "Modify User Activation",
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "52b34452-a49f-4298-9b75-1f43d8d66c7d",
            "id": 309
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "alerts",
                "resources": [
                    "alerts"
                ],
                "step_variables": {
                    "input": {
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    }
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "object",
                            "field": "type",
                            "value": "\/api\/3\/picklists\/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                            "_value": {
                                "itemValue": "Malware"
                            },
                            "operator": "eq"
                        },
                        {
                            "type": "primitive",
                            "field": "source",
                            "value": "Symantec EDR",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                }
            },
            "status": null,
            "top": "30",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/ea155646-3821-4542-9702-b246da430a8d",
            "uuid": "5ba36f7e-5f3f-4737-acfa-778cc2f40471",
            "id": 308
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch Assets Details",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "deviceUid",
                            "value": "{{vars.input.records[0].deviceUID}}",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                },
                "module": "assets?$limit=30",
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "uuid": "5f5363f4-1c9d-499b-b51e-6159f825b956",
            "id": 307
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "alertIRI": "{{vars.input.records[0]['@id']}}",
                "alertRawData": "{{vars.input.records[0].sourceData}}",
                "useMockOutput": "{{globalVars.Demo_mode}}"
            },
            "status": null,
            "top": "165",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "6aa72059-2a08-4c9b-af24-ea2ff8ac3cb1",
            "id": 310
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Endpoint Isolation Required",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/e5c5fe0b-1b89-4df9-abdb-773c63965fd9",
                        "condition": "{{ \"Malicious\" in vars.fileReputations }}"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/d1cc05df-ba93-4695-9aed-feab338d628f"
                    }
                ]
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "70a1b2cb-ec90-4bed-a363-4a05476d7697",
            "id": 315
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<span style=\"font-size: 15px; color: #DE7A13;\" class=\"fa fa-exclamation-triangle\"><\/span>&nbsp;Investigating Potential {{vars.input.records[0].type.itemValue}}, with following fields of interest:\n{% if vars.input.records[0].domain %}Domain: {{vars.input.records[0].domain -}}{% endif %}\n{% if vars.input.records[0].sourceIp %}SourceIP: {{ vars.input.records[0].sourceIp -}}{% endif %}\n{% if vars.input.records[0].destinationIp %}DestinationIP: {{vars.input.records[0].destinationIp -}}{% endif %}\n{% if vars.input.records[0].fileHash %}File Hash: {{vars.input.records[0].fileHash -}}{% endif %}\n{% if vars.input.records[0].computerName %}ComputerName: {{vars.input.records[0].computerName -}}{% endif %}\n{% if vars.input.records[0].processName %}Process: {{vars.input.records[0].processName -}}{% endif %}\n{% if vars.input.records[0].sourceProcess %}SourceProcess: {{vars.input.records[0].sourceProcess -}}{% endif %}",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 113,
                        "@id": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Investigating",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Investigating",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "76736bff-6635-435f-83fa-b470ea222a07",
            "id": 316
        },
        {
            "@type": "WorkflowStep",
            "name": "Close Alert",
            "description": null,
            "arguments": {
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong><span style=\"color: #339966;\">Asset Contained.<\/span><\/strong><\/p>",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 6802,
                        "@id": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Closed",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Closed",
                        "orderIndex": 1
                    },
                    "closureNotes": "<p>Asset and user Containted<\/p>"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.alertIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1920",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "a00d1d9e-b79a-42b2-94b6-6031173eaedf",
            "id": 306
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for Approved Isolation",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "['{{vars.alertIRI}}']",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong><span style=\"color: #008000;\">Containment request approved.<\/span><\/strong><\/p>\n<p>Proceeding to Isolate the Host<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1245",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "bf0ae666-7bd4-4a1f-b771-7ad666a85ac1",
            "id": 311
        },
        {
            "@type": "WorkflowStep",
            "name": "No malicious file found",
            "description": null,
            "arguments": {
                "params": [],
                "message": {
                    "tenant": "{{vars.input.records[0].type['@id']}}",
                    "content": "<p><strong><span style=\"color: #339966;\">No malicious<\/span><\/strong>&nbsp;File found<\/p>",
                    "records": ""
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "975",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "d1cc05df-ba93-4695-9aed-feab338d628f",
            "id": 318
        },
        {
            "@type": "WorkflowStep",
            "name": "Create note for the approval",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "['{{vars.alertIRI}}']",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Requested Approval from&nbsp;SOC team member&nbsp;to contain the User and Asset.<br><strong> <span style=\"background:#ba6204; color: #fff;\" class=\"badge badge-pill badge-danger\">Awaiting Confirmation.<\/span><\/strong><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "975",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "e5c5fe0b-1b89-4df9-abdb-773c63965fd9",
            "id": 317
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify IT team to start the asset clean up process",
            "description": null,
            "arguments": {
                "name": "SMTP",
                "config": "8dcaad2a-8cc4-4156-a95e-87e420f76a1f",
                "params": {
                    "cc": "user@example.com",
                    "to": "cyopsit_team@example.com",
                    "bcc": "",
                    "from": "no-reply@cybersponse.com",
                    "content": "<p>Hi Team,<\/p>\n<p>Following asset has been isolated due to malware infection.<\/p>\n<p>Please initiate asset clean-up procedure.<\/p>\n<p>Asset details:<\/p>\n<table border=\"1px solid black\" style=\"width: 732px; float: left;\">\n<tbody>\n<tr>\n<td style=\"width: 95px;\">Owner<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].managedBy}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">Device Name<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].hostname}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">IP Address<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].ip}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">Owner's Email ID<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].emailID}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">OS<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].operatingSystem.itemValue}}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<p>Infection details:<\/p>\n<table border=\"1px solid black\" style=\"width: 732px;\">\n<tbody>\n<tr>\n<td style=\"width: 146px;\">File Hashes&nbsp;<\/td>\n<td style=\"width: 237px;\">{% for item in vars.steps.Get_File_Reputation %}{% if \"Malicious\" in item.data.result.reputation %}{{item.data.result['SHA256']}}, {% endif %}{% endfor %}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<p>Thanks,<\/p>\n<p>InfoSec Team<\/p>",
                    "subject": "Clean Infected Asset : {{vars.steps.Fetch_Assets_Details[0].hostname}}",
                    "iri_list": "",
                    "file_name": "",
                    "file_path": ""
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Mailed IT Team to initiate the asset clean-up procedure.<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "2.4.2",
                "connector": "smtp",
                "operation": "send_richtext_email",
                "ignore_errors": true,
                "operationTitle": "Send Rich Text Email",
                "step_variables": []
            },
            "status": null,
            "top": "1785",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "ea09d784-cc4a-4834-a006-8d53dcf63579",
            "id": 312
        },
        {
            "@type": "WorkflowStep",
            "name": "Isolate Endpoint",
            "description": null,
            "arguments": {
                "name": "Symantec ATP",
                "config": "74785d28-4798-404e-92bc-4c0f0a01a1c4",
                "params": {
                    "targets": "{{vars.request.data.deviceUID}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Isolated the device,<strong>{{vars.request.data.deviceUID}}&nbsp;&nbsp;<\/strong>successfully.&nbsp;<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "1.0.0",
                "connector": "symantec-atp",
                "operation": "isolate_endpoint",
                "mock_result": "{\n       \"command_id\": \"12daad22ddd23s12daad22ddd23s-2018-04-27\"\n }",
                "operationTitle": "Isolate Endpoint",
                "step_variables": []
            },
            "status": null,
            "top": "1515",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "f6616a2d-7498-43fb-b12c-c3d639684862",
            "id": 305
        },
        {
            "@type": "WorkflowStep",
            "name": "No Isolation is required",
            "description": null,
            "arguments": {
                "params": [],
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>No Isolation of endpoint is required<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "1245",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "fcdc8a64-b1d1-467b-bec7-1d7f2e82bcfd",
            "id": 313
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Get File Reputation -> Is Endpoint Isolation Required",
            "targetStep": "\/api\/3\/workflow_steps\/70a1b2cb-ec90-4bed-a363-4a05476d7697",
            "sourceStep": "\/api\/3\/workflow_steps\/01fa6bd9-58e6-4c81-ab97-e95903e90835",
            "label": null,
            "isExecuted": false,
            "uuid": "47c0be22-37fe-433c-a34a-74f5f7694ccb"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Seek approval to contain -> No Isolation is required",
            "targetStep": "\/api\/3\/workflow_steps\/fcdc8a64-b1d1-467b-bec7-1d7f2e82bcfd",
            "sourceStep": "\/api\/3\/workflow_steps\/3ffbda07-e69e-4f98-9bd7-ce7e2fcc93a6",
            "label": "Reject",
            "isExecuted": false,
            "uuid": "650a3f65-d7c2-45f7-8e8b-c1f85104e682"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Fetch Assets Details",
            "targetStep": "\/api\/3\/workflow_steps\/5f5363f4-1c9d-499b-b51e-6159f825b956",
            "sourceStep": "\/api\/3\/workflow_steps\/76736bff-6635-435f-83fa-b470ea222a07",
            "label": null,
            "isExecuted": false,
            "uuid": "99f8b9ec-577c-4212-acb3-9ec2824afaf0"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Endpoint Isolation Required -> No malicious file found1",
            "targetStep": "\/api\/3\/workflow_steps\/d1cc05df-ba93-4695-9aed-feab338d628f",
            "sourceStep": "\/api\/3\/workflow_steps\/70a1b2cb-ec90-4bed-a363-4a05476d7697",
            "label": "No",
            "isExecuted": false,
            "uuid": "bb212a42-fbb5-4cd4-883a-d2a8de39fa96"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch Assets Details -> Create or Link Assets",
            "targetStep": "\/api\/3\/workflow_steps\/0e1b8eb7-a564-4145-bf61-dce1dec49665",
            "sourceStep": "\/api\/3\/workflow_steps\/5f5363f4-1c9d-499b-b51e-6159f825b956",
            "label": null,
            "isExecuted": false,
            "uuid": "68ecb049-5675-4b11-856a-2ede957d1290"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Seek approval to contain -> Create Note for Approved Isolation",
            "targetStep": "\/api\/3\/workflow_steps\/bf0ae666-7bd4-4a1f-b771-7ad666a85ac1",
            "sourceStep": "\/api\/3\/workflow_steps\/3ffbda07-e69e-4f98-9bd7-ce7e2fcc93a6",
            "label": "Approve",
            "isExecuted": false,
            "uuid": "a220f3f7-a090-45aa-92e8-b5a20b7d65e8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Note for Approved Isolation -> Delete File from Endpoint",
            "targetStep": "\/api\/3\/workflow_steps\/36b65970-019a-4dc5-b697-f02c730fdfca",
            "sourceStep": "\/api\/3\/workflow_steps\/bf0ae666-7bd4-4a1f-b771-7ad666a85ac1",
            "label": null,
            "isExecuted": false,
            "uuid": "8bc6e766-0c7c-45c7-8535-eb60bab82631"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Isolate Endpoint -> Deactivate User in CloudSOC",
            "targetStep": "\/api\/3\/workflow_steps\/52b34452-a49f-4298-9b75-1f43d8d66c7d",
            "sourceStep": "\/api\/3\/workflow_steps\/f6616a2d-7498-43fb-b12c-c3d639684862",
            "label": null,
            "isExecuted": false,
            "uuid": "0c741a65-ddc2-4e0b-958c-32b05774832a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/6aa72059-2a08-4c9b-af24-ea2ff8ac3cb1",
            "sourceStep": "\/api\/3\/workflow_steps\/5ba36f7e-5f3f-4737-acfa-778cc2f40471",
            "label": null,
            "isExecuted": false,
            "uuid": "5e4b99d4-3b55-452a-b30e-a4ff10ec1f6b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/76736bff-6635-435f-83fa-b470ea222a07",
            "sourceStep": "\/api\/3\/workflow_steps\/6aa72059-2a08-4c9b-af24-ea2ff8ac3cb1",
            "label": null,
            "isExecuted": false,
            "uuid": "dd294643-dc1f-4d55-a2ad-80cd937c5ff5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "is Endpoint Isolation Required -> Create note for the approval",
            "targetStep": "\/api\/3\/workflow_steps\/e5c5fe0b-1b89-4df9-abdb-773c63965fd9",
            "sourceStep": "\/api\/3\/workflow_steps\/70a1b2cb-ec90-4bed-a363-4a05476d7697",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "e53284e9-2e2e-46a0-a577-271594f192f3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create note for the approval -> Seek approval to contain",
            "targetStep": "\/api\/3\/workflow_steps\/3ffbda07-e69e-4f98-9bd7-ce7e2fcc93a6",
            "sourceStep": "\/api\/3\/workflow_steps\/e5c5fe0b-1b89-4df9-abdb-773c63965fd9",
            "label": null,
            "isExecuted": false,
            "uuid": "fed64ae2-218e-4f16-b536-eb37e7bc1e6a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Notify IT team to start the asset clean up process -> Closing Alert record",
            "targetStep": "\/api\/3\/workflow_steps\/a00d1d9e-b79a-42b2-94b6-6031173eaedf",
            "sourceStep": "\/api\/3\/workflow_steps\/ea09d784-cc4a-4834-a006-8d53dcf63579",
            "label": null,
            "isExecuted": false,
            "uuid": "74c22c0d-8c6a-4d41-847e-a4afc4a8e3bb"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Delete File from Endpoint -> Isolate Endpoint",
            "targetStep": "\/api\/3\/workflow_steps\/f6616a2d-7498-43fb-b12c-c3d639684862",
            "sourceStep": "\/api\/3\/workflow_steps\/36b65970-019a-4dc5-b697-f02c730fdfca",
            "label": null,
            "isExecuted": false,
            "uuid": "9f56589a-f07b-4721-933a-afa1f8b356d3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create or Link Assets -> Get File Reputation",
            "targetStep": "\/api\/3\/workflow_steps\/01fa6bd9-58e6-4c81-ab97-e95903e90835",
            "sourceStep": "\/api\/3\/workflow_steps\/0e1b8eb7-a564-4145-bf61-dce1dec49665",
            "label": null,
            "isExecuted": false,
            "uuid": "0ec50464-458f-4f02-97d8-66a8e90fa0e9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Deactivate User in CloudSOC -> Notify IT team to start the asset clean up process",
            "targetStep": "\/api\/3\/workflow_steps\/ea09d784-cc4a-4834-a006-8d53dcf63579",
            "sourceStep": "\/api\/3\/workflow_steps\/52b34452-a49f-4298-9b75-1f43d8d66c7d",
            "label": null,
            "isExecuted": false,
            "uuid": "0ed46617-db62-4a31-a03f-3833a10b8d86"
        }
    ],
    "priority": null,
    "uuid": "3f11ef71-f1c7-497d-af2d-9f9b6be061d0",
    "recordTags": [
        "PostCreate",
        "Alerts"
    ],
    "id": 72,
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1637679537,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1637679537,
    "owners": [],
    "isPrivate": false
}